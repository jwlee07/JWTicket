{% extends "review/base.html" %}

{% block content %}
<div class="content-container mt-5">
    <div class="d-flex align-items-center justify-content-between">
        <!-- 리뷰 분석 결과 제목 -->
        <h1 class="text-center flex-grow-1">리뷰 분석 결과</h1>
    </div>

    <div class="mt-4">
        {% if analysis_type == 'long_reviews' %}
        <h3 class="mt-3">길게 남긴 리뷰</h3>
        <ul class="list-group">
            {% for review in data %}
            <li class="list-group-item">
                <p><strong>닉네임:</strong> {{ review.nickname }}</p>
                <p><strong>평점:</strong> {{ review.star_rating }}</p>
                <p><strong>내용:</strong> {{ review.description }}</p>
            </li>
            <hr>
            {% endfor %}
        </ul>

        {% elif analysis_type == 'frequent_reviewers' %}
        <h3 class="mt-3">여러 번 리뷰를 작성한 고객</h3>
        <ul class="list-group">
            {% for reviewer in data %}
            <li class="list-group-item">
                <strong>{{ reviewer.nickname }}</strong> - {{ reviewer.review_count }}회 작성
                <ul>
                    {% for review in reviewer.reviews %}
                    <li>
                        {{ review.description|truncatewords:20 }}
                    </li>
                    {% endfor %}
                </ul>
            </li>
            {% endfor %}
        </ul>

        {% elif analysis_type == 'frequent_words' %}
        <h3 class="mt-3">자주 등장한 단어</h3>
        <ul class="list-group">
            {% for word, count in data %}
            <li class="list-group-item">
                <strong>{{ word }}:</strong> {{ count }}회
            </li>
            {% endfor %}
        </ul>

        {% elif analysis_type == 'similar_reviews' %}
        <h3 class="mt-3">비슷한 리뷰</h3>
        <ul class="list-group">
            {% for review1, review2, score in data %}
            <li class="list-group-item">
                <strong>리뷰 1:</strong> {{ review1|truncatewords:30 }}<br>
                <strong>리뷰 2:</strong> {{ review2|truncatewords:30 }}<br>
                <strong>유사도:</strong> {{ score|floatformat:2 }}
            </li>
            {% endfor %}
        </ul>

        {% elif analysis_type == 'top_view_count_reviews' %}
        <h3 class="mt-3">조회수가 높은 리뷰</h3>
        <ul class="list-group">
            {% for review in data %}
            <li class="list-group-item">
                <p><strong>닉네임:</strong> {{ review.nickname }}</p>
                <p><strong>조회수:</strong> {{ review.view_count }}</p>
                <p><strong>내용:</strong> {{ review.description }}</p>
            </li>
            <hr>
            {% endfor %}
        </ul>

        {% elif analysis_type == 'low_star_rating_reviews' %}
        <h3 class="mt-3">평점이 낮은 리뷰</h3>
        <ul class="list-group">
            {% for review in data %}
            <li class="list-group-item">
                <p><strong>닉네임:</strong> {{ review.nickname }}</p>
                <p><strong>평점:</strong> {{ review.star_rating }}</p>
                <p><strong>내용:</strong> {{ review.description }}</p>
            </li>
            <hr>
            {% endfor %}
        </ul>

        {% else %}
        <p class="text-muted text-center">분석 데이터를 찾을 수 없습니다.</p>
        {% endif %}
    </div>
</div>
{% endblock content %}
